このドライバーはロータリーエンコーダーのA, Bの両ピンの状態を2ビットのワードにエンコードし、過去4ワードの履歴と現在の1ワードを検査して回転が成功したかどうかと回転の方向を判断している。

EC12互換のロータリーエンコーダーは時計回りの回転の際に、A接続、B接続、A切断、B切断の順序で操作が行われる。また反時計回りの場合はAとBの順序が逆になりB接続、A接続、B切断、A切断の順序で操作が行われる。本ドライバーはCをGNDに接続し、AとBをプルアップした状態であることを仮定している。そのためAとBともに初期状態はHi状態であり、接続に伴いそれぞれLo状態になり、切断にともないHi状態になることを期待している。

本ドライバはA, Bの両ピンをワードにエンコードする際に、Hi状態を0にエンコードしLo状態を1にエンコードする。またAを0ビット目にBを1ビット目に割り当てる。この操作により得られる2ビットワードとA, B両ピンの対応関係は以下の表の通りとなる。

| Word | B | A |
|-----:|---|---|
| 00   |Hi |Hi |
| 01   |Hi |Lo |
| 11   |Lo |Lo |
| 10   |Lo |Hi |

時計回りにノブを回した際は 00 を初期状態として 01, 11, 10, 00 という順序で2ビットワードが遷移する。逆に反時計回りにノブを回した際は 00 を初期状態として 10, 11, 01, 00 という順序で2ビットワードが遷移する。

この2ビットワードの過去4ワード分の遷移履歴を、ビットシフトを用いて8ビット=1バイトの変数の下位から順に詰め込むと、時計回りの回転は 0x1e (=00, 01, 11, 10)となり、反時計回りの回転は 0x2d (=00, 10, 11, 01)となる。最新の2ビットワードが 00 の時に、遷移履歴を示す変数を前述の値と比較することで、回転が成功したかどうか及び回転の方向を判定する。
